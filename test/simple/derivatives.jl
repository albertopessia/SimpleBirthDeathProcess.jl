# precise values were computed with Maple 2018.2.1
@testset "Type stability" begin
  @testset for F = [Float32, Float64, BigFloat]
    x, y = SimpleBirthDeathProcess.derivatives_mle(F(1), 1, 0, F(1), F(1))
    @test isa(x, F)
    @test isa(y, F)

    x, y = SimpleBirthDeathProcess.derivatives_mle(F(1), 1, 0, F(1), F(0))
    @test isa(x, F)
    @test isa(y, F)

    x, y = SimpleBirthDeathProcess.derivatives_mle(F(1.0e-6), 1, 0, F(1), F(1.0e-6))
    @test isa(x, F)
    @test isa(y, F)

    x, y = SimpleBirthDeathProcess.derivatives_mle(F(1.0e-6), 1, 0, F(1), F(0))
    @test isa(x, F)
    @test isa(y, F)
  end
end

@testset "Equal rates" begin
  ϵ = 1.0e-7

  u = ((1, 0), (1, 1), (100, 0), (100, 1), (100, 50), (100, 100), (100, 200))
  v = ((0.001, 0.001), (0.001, 0.1), (0.001, 1.0), (0.001, 10.0), (0.001, 100.0),
       (  0.1, 0.001), (  0.1, 0.1), (  0.1, 1.0), (  0.1, 10.0), (  0.1, 100.0),
       (  1.0, 0.001), (  1.0, 0.1), (  1.0, 1.0), (  1.0, 10.0), (  1.0, 100.0),
       ( 10.0, 0.001), ( 10.0, 0.1), ( 10.0, 1.0), ( 10.0, 10.0), ( 10.0, 100.0),
       (100.0, 0.001), (100.0, 0.1), (100.0, 1.0), (100.0, 10.0), (100.0, 100.0))

  # case i = 1, j = 0
  f1 = [999.99900000100000, 9.9990000999900010, .99900099900099900, .99009900990099010e-1, .90909090909090909e-2, 999.90000999900010, 9.9009900990099010, .90909090909090909, .50000000000000000e-1, .90909090909090909e-3, 999.00099900099900, 9.0909090909090909, .50000000000000000, .90909090909090909e-2, .99009900990099010e-4, 990.09900990099010, 5., .90909090909090909e-1, .99009900990099010e-3, .99900099900099900e-5, 909.09090909090909, .90909090909090909, .99009900990099010e-2, .99900099900099900e-4, .99990000999900010e-6]
  g1 = [-999999.99999900000, -99.999999000199970, -.99999900199700400, -.99990197039505931e-2, -.99173553719008264e-4, -999999.99000199970, -99.990197039505931, -.99173553719008264, -.75000000000000000e-2, -.17355371900826446e-4, -999999.00199700400, -99.173553719008264, -.75000000000000000, -.17355371900826446e-2, -.19703950593079110e-5, -999901.97039505931, -75., -.17355371900826446, -.19703950593079110e-3, -.19970039950059930e-6, -991735.53719008264, -17.355371900826446, -.19703950593079110e-1, -.19970039950059930e-4, -.19997000399950006e-7]

  # case i = 1, j = 1
  f2 = [-1999999999998000.0, -1999999980.0019998, -1999998.0019980020, -1999.8019801980198, -1.9818181818181818, -199999998000.19998, -199980.19801980198, -198.18181818181818, -.10000000000000000, .16181818181818182e-2, -1999998001.9980020, -1981.8181818181818, -1., .16181818181818182e-1, .19601980198019802e-3, -19998019.801980198, -10., .16181818181818182, .19601980198019802e-2, .19960019980019980e-4, -198181.81818181818, 1.6181818181818182, .19601980198019802e-1, .19960019980019980e-3, .19996000199980002e-5]
  g2 = [-.39999999999940000e31, -.39999999400000002e19, -3999994000002.0000, -3999400.0199980394, -3.9401983471074380, -.39999999400000002e23, -39994000199.980394, -39401.983471074380, .50000000000000000e-2, -.28750743801652893e-4, -.39999940000020000e19, -3940198.3471074380, .50000000000000000, -.28750743801652893e-2, -.38807941186158220e-5, -399940001999803.94, 50., -.28750743801652893, -.38807941186158220e-3, -.39880079940119860e-6, -39401983471.074380, -28.750743801652893, -.38807941186158220e-1, -.39880079940119860e-4, -.39988000799940012e-7]

  # case i = 100, j = 0
  f3 = [99999.900000100000, 999.90000999900010, 99.900099900099900, 9.9009900990099010, .90909090909090909, 99990.000999900010, 990.09900990099010, 90.909090909090909, 5., .90909090909090909e-1, 99900.099900099900, 909.09090909090909, 50., .90909090909090909, .99009900990099010e-2, 99009.900990099010, 500., 9.0909090909090909, .99009900990099010e-1, .99900099900099900e-3, 90909.090909090909, 90.909090909090909, .99009900990099010, .99900099900099900e-2, .99990000999900010e-4]
  g3 = [-99999999.999900000, -9999.9999000199970, -99.999900199700400, -.99990197039505931, -.99173553719008264e-2, -99999999.000199970, -9999.0197039505931, -99.173553719008264, -.75000000000000000, -.17355371900826446e-2, -99999900.199700400, -9917.3553719008264, -75., -.17355371900826446, -.19703950593079110e-3, -99990197.039505931, -7500., -17.355371900826446, -.19703950593079110e-1, -.19970039950059930e-4, -99173553.719008264, -1735.5371900826446, -1.9703950593079110, -.19970039950059930e-2, -.19997000399950006e-5]

  # case i = 100, j = 1
  f4 = [-1999999999899000.1, -1999998990.1009899, -1999899.1008991009, -1990., -1.0818181818181818, -199999899010.09899, -199000., -108.18181818181818, 4.8500000000000000, .91618181818181818e-1, -1999899100.8991009, -1081.8181818181818, 48.500000000000000, .91618181818181818, .99980000000000000e-2, -19900000., 485., 9.1618181818181818, .99980000000000000e-1, .10089710089910090e-2, -108181.81818181818, 91.618181818181818, .99980000000000000, .10089710089910090e-1, .10098970100989901e-3]
  g4 = [-.39999999999940000e31, -.39999999400000101e19, -3999994000100.9999, -3999401.0099009901, -3.9500165289256198, -.39999999400000101e23, -39994010099.009901, -39500.165289256198, -.73750000000000000, -.17469325619834711e-2, -.39999940001009999e19, -3950016.5289256198, -73.750000000000000, -.17469325619834711, -.19894990499009901e-3, -399940100990099.01, -7375., -17.469325619834711, -.19894990499009901e-1, -.20169140349960529e-4, -39500165289.256198, -1746.9325619834711, -1.9894990499009901, -.20169140349960529e-2, -.20196910403949906e-5]

  # case i = 100, j = 50
  f5 = [49999.850000246078, 499.85002460634302, 49.850245928311393, 4.8524456631044051, .37298460412225438, 49985.002460634302, 485.24456631044051, 37.298460412225438, .78859060402684564, .32954543518210715e-2, 49850.245928311393, 372.98460412225438, 7.8859060402684564, .32954543518210715e-1, -.96294324964840534e-2, 48524.456631044051, 78.859060402684564, .32954543518210715, -.96294324964840534e-1, -.18549966956099172e-1, 37298.460412225438, 3.2954543518210715, -.96294324964840534, -.18549966956099172, -.19850500094340469e-1]
  g5 = [-49999999.999753922, -4999.9997539515722, -49.999754221928715, -.49975695805708625, -.47875471310855029e-2, -49999997.539515722, -4997.5695805708625, -47.875471310855029, -.15858382931375139, -.12186787753961179e-3, -49999754.221928715, -4787.5471310855029, -15.858382931375139, -.12186787753961179e-1, .32276900650245867e-4, -49975695.805708625, -1585.8382931375139, -1.2186787753961179, .32276900650245867e-2, .17149816384207482e-3, -47875471.310855029, -121.86787753961179, .32276900650245867, .17149816384207482e-1, .19701500273202451e-3]

  # case i = 100, j = 100
  f6 = [-.19998000000029997, -.19800010196333614, -.18009950811664896, -.60447300397780170e-1, -.50677738951619623e-2, -19.800010196333614, -6.0447300397780170, -.50677738951619623, -.50251256281407035e-1, -.51981725528326359e-2, -180.09950811664896, -5.0677738951619623, -.50251256281407035, -.51981725528326359e-1, -.86626317379107451e-2, -604.47300397780170, -5.0251256281407035, -.51981725528326359, -.86626317379107451e-1, -.18099841881899484e-1, -506.77738951619623, -5.1981725528326359, -.86626317379107451, -.18099841881899484, -.19801000081347084e-1]
  g6 = [.19999999300090003e-1, .19996961233183819e-1, .19702990379748488e-1, .65689829404052553e-2, .51355005977672478e-4, 199.96961233183819, 65.689829404052553, .51355005977672478, .50124996843514053e-2, .49904596248999107e-4, 19702.990379748488, 51.355005977672478, .50124996843514053, .49904596248999107e-2, .38335168998258595e-4, 656898.29404052553, 50.124996843514053, .49904596248999107, .38335168998258595e-2, .16299192237740363e-3, 513550.05977672478, 49.904596248999107, .38335168998258595, .16299192237740363e-1, .19603000208736252e-3]

  # case i = 100, j = 200
  f7 = [99999.700000496039, 999.70004960096013, 99.700495739334726, 9.7049301243676483, .74633023288997819, 99970.004960096013, 970.49301243676483, 74.633023288997819, 1.6220735785953177, .12020362329772666e-1, 99700.495739334726, 746.33023288997819, 16.220735785953177, .12020362329772666, -.55126928194876409e-2, 97049.301243676483, 162.20735785953177, 1.2020362329772666, -.55126928194876409e-1, -.17199343930916377e-1, 74633.023288997819, 12.020362329772666, -.55126928194876409, -.17199343930916377, -.19702000030364999e-1]
  g7 = [-99999999.999503961, -9999.9995040204041, -99.999504561204038, -.99951004214460955, -.95719912660330227e-2, -99999995.040204041, -9995.1004214460955, -95.719912660330227, -.32061900197954334, -.29316732851538443e-3, -99999504.561204038, -9571.9912660330227, -32.061900197954334, -.29316732851538443e-1, .42273823169645906e-5, -99951004.214460955, -3206.1900197954334, -2.9316732851538443, .42273823169645906e-3, .14596709247912786e-3, -95719912.660330227, -293.16732851538443, .42273823169645906e-1, .14596709247912786e-1, .19405999954831659e-3]

  m1 = [f1 f2 f3 f4 f5 f6 f7]
  m2 = [g1 g2 g3 g4 g5 g6 g7]

  @testset for (b, (i, j)) = enumerate(u)
    @testset for (a, (t, μ)) = enumerate(v)
      x, y = SimpleBirthDeathProcess.derivatives_mle(μ, i, j, t, 0.0)
      @test isapprox(x, m1[a, b], rtol=ϵ)
      @test isapprox(y, m2[a, b], rtol=ϵ)
    end
  end
end

@testset "Unequal rates" begin
  ϵ = 1.0e-5

  u = ((1, 0), (1, 1), (100, 0), (100, 1), (100, 2), (100, 50), (100, 100), (100, 200))

  # Tuples (t, λ - μ, λ)
  # θ = λ - μ = [-10, -1, -0.0001, 0.0001, 1, 10]
  # μ = λ - θ
  # when θ is negative parameter λ can assume any positive value
  # when θ is positive parameter λ must satisfy the constraint μ = λ - θ > 0
  v = ((0.001,   -10.0,  0.0001), (0.001,   -10.0,     1.0), (0.001,   -10.0,    10.0),
       (0.001,    -1.0,  0.0001), (0.001,    -1.0,     1.0), (0.001,    -1.0,    10.0),
       (0.001, -0.0001,  0.0001), (0.001, -0.0001,     1.0), (0.001, -0.0001,    10.0),
       (0.001,  0.0001,  0.0002), (0.001,  0.0001,  1.0001), (0.001,  0.0001, 10.0001),
       (0.001,     1.0,  1.0001), (0.001,     1.0,     2.0), (0.001,     1.0,    11.0),
       (0.001,    10.0, 10.0001), (0.001,    10.0,    11.0), (0.001,    10.0,    20.0))

  # case i = 1, j = 0
  f1 = [.99003983483922504e-1, .89915063357946893e-1, .49014786413891167e-1, .99890050993227514, .49900149783645383, .89919481886297655e-1, 4999.9990000001500, .99890100904989925, .99008901049113711e-1, 9999.9990000001500, .99900099905089915, .99009901039113811e-1, 9999.9990004999333, .99900149783645383, .99010390977206746e-1, 9999.9990049834739, .99900597244885598, .99014786413891167e-1, .45399021798120317e-5, .37520757967653101e-5, .11350240090672665e-5, .36781940628488687, .11269983678028204, .45680434947151608e-2, 4999.0001499783365, .49991250989483083, .90903223290581980e-2, 9999.0001499783365, .50001249989583073, .90913223190582980e-2, 9999.3679193962859, .61269983678028204, .13658952585624252e-1, 9999.9000055398922, .90909466116670586, .50001135024009067e-1, .37200015756173235e-44, .30744429553891206e-44, .93001899400520899e-45, .45390851344402211e-4, .11350240090672665e-4, .37522151748631545e-6, 4990.0149783645383, .90850428230365088e-1, .98958924718965741e-3, 9990.0149783645383, .90950418231364988e-1, .99058923718975740e-3, 9999.0001453808523, .50001135024009067, .90912843124265772e-2, 9999.9000009999900, .90909090909090909, .50000000000000000e-1]
  g1 = [-.99988099451127929e-2, -.82634747191449220e-2, -.24990293541897466e-2, -.99979903099561712, -.24999900299342939, -.82634834838993616e-2, -24999999.999999000, -.99979903199310420, -.99988197070476121e-2, -99999999.999999000, -.99999900199710370, -.99990197040476521e-2, -99999999.999999001, -.99999900299342939, -.99990206739820062e-2, -99999999.999999010, -.99999901190922757, -.99990293541897466e-2, -.90795074553704159e-6, -.68218152133908989e-6, -.11350111262722549e-6, -.60027414040440265, -.99998583569979827e-1, -.80968634130587429e-3, -24999999.000299934, -.74981252973558383, -.17354123253026121e-2, -99999999.000299934, -.75001249973958333, -.17356123223026521e-2, -99999999.600474110, -.84999858356997983, -.25452235313885189e-2, -99999999.990001108, -.99173621937160398, -.75001135011126272e-2, -.74399287519471274e-45, -.55898962825256739e-45, -.93001899400520899e-46, -.90770565096876027e-4, -.11350111262722549e-4, -.68221953297233806e-7, -24999900.299342939, -.17342888788227027, -.19693658340107530e-3, -99999900.299342939, -.17362885788626977, -.19713658040111530e-3, -99999999.000290741, -.75001135011126272, -.17356054120359419e-2, -99999999.990000200, -.99173553719008264, -.75000000000000000e-2]

  # case i = 1, j = 1
  f2 = [-.19900330521547921e-2, -.19880551022880312e-2, -.19704271722176668e-2, -.19990001334499200e-2, -.19970043270923370e-2, -.19792180455865073e-2, -.19999997000000433e-2, -.19980018982017017e-2, -.19801979217723785e-2, -.19999997000000433e-2, -.19980018982017017e-2, -.19801979217723785e-2, -.19990001334499200e-2, -.19970043270923370e-2, -.19792180455865073e-2, -.19900330521547921e-2, -.19880551022880312e-2, -.19704271722176668e-2, -.19998892021564018, -.18181067766658829, -.99997729951981865e-1, -1.2641612074282265, -.77460032643943592, -.17268209482875150, -1.9997000433270842, -.99997500020833854, -.18181735536188340, -1.9997000433270842, -.99997500020833854, -.18181735536188340, -1.2641612074282265, -.77460032643943592, -.17268209482875150, -.19998892021564018, -.18181067766658829, -.99997729951981865e-1, -.19999800001999980, -.18181818181818182, -.10000000000000000, -1.9997092382953114, -.99997729951981865, -.18181743137514685, -19.970043270923370, -1.8180991635372700, -.19801882152562049, -19.970043270923370, -1.8180991635372700, -.19801882152562049, -1.9997092382953114, -.99997729951981865, -.18181743137514685, -.19999800001999980, -.18181818181818182, -.10000000000000000]
  g2 = [.19801157743342588e-5, .19761815448667371e-5, .19412916205068554e-5, .19980007667663990e-5, .19940131412127589e-5, .19586520359876368e-5, .19999994000001317e-5, .19960057926088016e-5, .19605919046958234e-5, .19999994000001317e-5, .19960057926088016e-5, .19605919046958234e-5, .19980007667663990e-5, .19940131412127589e-5, .19586520359876368e-5, .19801157743342588e-5, .19761815448667371e-5, .19412916205068554e-5, .19997784104508846e-1, .16527561256792033e-1, .49997729977747455e-2, .79905177918319571, .30000283286004035, .14909552937222962e-1, 1.9994001316411713, .49997500052083333, .16528775355394696e-1, 1.9994001316411713, .49997500052083333, .16528775355394696e-1, .79905177918319571, .30000283286004035, .14909552937222962e-1, .19997784104508846e-1, .16527561256792033e-1, .49997729977747455e-2, .19999600005999920e-1, .16528925619834711e-1, .50000000000000000e-2, 1.9994185188618072, .49997729977747455, .16528789175928116e-1, 199.40131412127589, 1.6527422842274605, .19605726839197769e-1, 199.40131412127589, 1.6527422842274605, .19605726839197769e-1, 1.9994185188618072, .49997729977747455, .16528789175928116e-1, .19999600005999920e-1, .16528925619834711e-1, .50000000000000000e-2]

  # case i = 100, j = 0
  f3 = [9.9003983483922504, 8.9915063357946893, 4.9014786413891167, 99.890050993227514, 49.900149783645383, 8.9919481886297655, 499999.90000001500, 99.890100904989925, 9.9008901049113711, 999999.90000001500, 99.900099905089915, 9.9009901039113811, 999999.90004999333, 99.900149783645383, 9.9010390977206746, 999999.90049834739, 99.900597244885598, 9.9014786413891167, .45399021798120317e-3, .37520757967653101e-3, .11350240090672665e-3, 36.781940628488687, 11.269983678028204, .45680434947151608, 499900.01499783365, 49.991250989483083, .90903223290581980, 999900.01499783365, 50.001249989583073, .90913223190582980, 999936.79193962859, 61.269983678028204, 1.3658952585624252, 999990.00055398922, 90.909466116670586, 5.0001135024009067, .37200015756173235e-42, .30744429553891206e-42, .93001899400520899e-43, .45390851344402211e-2, .11350240090672665e-2, .37522151748631545e-4, 499001.49783645383, 9.0850428230365088, .98958924718965741e-1, 999001.49783645383, 9.0950418231364988, .99058923718975740e-1, 999900.01453808523, 50.001135024009067, .90912843124265772, 999990.00009999900, 90.909090909090909, 5.0000000000000000]
  g3 = [-.99988099451127929, -.82634747191449220, -.24990293541897466, -99.979903099561712, -24.999900299342939, -.82634834838993616, -2499999999.9999000, -99.979903199310420, -.99988197070476121, -9999999999.9999000, -99.999900199710370, -.99990197040476521, -9999999999.9999001, -99.999900299342939, -.99990206739820062, -9999999999.9999010, -99.999901190922757, -.99990293541897466, -.90795074553704159e-4, -.68218152133908989e-4, -.11350111262722549e-4, -60.027414040440265, -9.9998583569979827, -.80968634130587429e-1, -2499999900.0299934, -74.981252973558383, -.17354123253026121, -9999999900.0299934, -75.001249973958333, -.17356123223026521, -9999999960.0474110, -84.999858356997983, -.25452235313885189, -9999999999.0001108, -99.173621937160398, -.75001135011126272, -.74399287519471274e-43, -.55898962825256739e-43, -.93001899400520899e-44, -.90770565096876027e-2, -.11350111262722549e-2, -.68221953297233806e-5, -2499990029.9342939, -17.342888788227027, -.19693658340107530e-1, -9999990029.9342939, -17.362885788626977, -.19713658040111530e-1, -9999999900.0290741, -75.001135011126272, -.17356054120359419, -9999999999.0000200, -99.173553719008264, -.75000000000000000]

  # case i = 100, j = 1
  f4 = [9.7994043318561731, 8.8996032173344544, 4.8504934278030078, 98.889151483161789, 49.399151281481837, 8.9000494886978814, 494999.89900001515, 98.889201894041824, 9.7999010059404850, 989999.89900001515, 98.899100904140814, 9.8000000049504949, 989999.89905049326, 98.899151281481837, 9.8000494886978814, 989999.89950333087, 98.899603217334454, 9.8004934278030078, -.19953946989983878, -.18143922216270852, -.99885362575084206e-1, 35.149960014775573, 10.382683514808486, .27955421114804942, 494899.01514781198, 48.491363479379914, .71812455521487820, 989899.01514781198, 48.501262489478904, .71822355422488810, 989936.15985902487, 59.882683514808486, 1.1795542111480494, 989989.90055952911, 89.818560777837291, 4.8501146374249158, -.19999800001999980, -.18181818181818182, -.10000000000000000, -1.9952155440122156, -.99885362575084206, -.18178028444491570, 493991.51281481837, 7.1760932312688737, -.10004948605384440, 988991.51281481837, 7.1859922413678638, -.99950487043834502e-1, 989899.01468346609, 48.501146374249158, .71821971555508430, 989989.90010099899, 89.818181818181818, 4.8500000000000000]
  g4 = [-.98988020445039216, -.81808202101380241, -.24740196477316440, -98.980102070565328, -24.749899302336369, -.81808290625400081, -2474999999.9998990, -98.980102171311523, -.98988119040580890, -9899999999.9998990, -98.999899201707473, -.98990099010881286, -9899999999.9998991, -98.999899302336369, -.98990108807218262, -9899999999.9999000, -98.999900202831984, -.98990196477316440, .19907896980700679e-1, .16460025286179463e-1, .49885363876246502e-2, -58.628088120852666, -9.5998569405679625, -.65249394852058592e-1, -2474999899.0302934, -73.731465443301966, -.15527704484956390, -9899999899.0302934, -73.751262473697917, -.15529684455256786, -9899999959.6478852, -83.849856940567963, -.23706757667024041, -9899999998.9901119, -98.165358156532002, -.73751146361237535, .19999600005999920e-1, .16528925619834711e-1, .50000000000000000e-2, 1.9904322329172165, .49885363876246502, .16522035202551690e-1, -2474989930.2336369, -15.516717616117296, .10900508249131511e-3, -9899989930.2336369, -15.536514646513247, .89205379487355162e-4, -9899999899.0293648, -73.751146361237535, -.15529614661563013, -9899999998.9900202, -98.165289256198347, -.73750000000000000]

  # case i = 100, j = 2
  f5 = [9.6984105173460218, 8.8077003413004283, 4.7995088202801068, 97.888251993302126, 48.898152839924354, 8.8081512130075141, 489999.89800001531, 97.888302923499783, 9.6989123110112069, 979999.89800001531, 97.898101943597773, 9.6990103100312167, 979999.89805101340, 97.898152839924354, 9.6990603039166050, 979999.89850851637, 97.898609432209519, 9.6995088202801068, 43.898127922641105, .70581246865714004, -.50052600885841551e-1, 33.539926393342232, 9.5584438770067158, .23728863770408844, 489898.01530385092, 47.031081831475705, .66099591582815119, 979898.01530385092, 47.040880851573695, .66109391484816099, 979935.54972541344, 58.558443877006716, 1.1281977286131793, 980034.09822592166, 89.796721559566231, 4.8499473991141584, 9999.7000029999700, .72727272727272727, -.50000000000000000e-1, 422.07339505003392, -.50052600885841551, -.17269290067365497, 488981.52839924354, 6.6049137252366498, -.10004400564482320, 978981.52839924354, 6.6147127453346400, -.99946006624813402e-1, 980324.08319407013, 48.499473991141584, .71821619023543594, 989989.90010099899, 89.818181818181818, 4.8500000000000000]
  g5 = [-.97987937398516874, -.80981652970880327, -.24490095372350761, -97.980301001164901, -24.499898264925760, -.80981742371429145, -2449999999.9998980, -97.980301102908588, -.97988036970306106, -9799999999.9998980, -97.999898163300539, -.97989996940906498, -9799999999.9998981, -97.999898264925760, -.97990006834239063, -9799999999.9998990, -97.999899174336902, -.97990095372350761, -1953.3834954447087, -.93173641464911912, -.24723183516223411e-2, -57.185358664217155, -9.1617918037252981, -.54895315483572025e-1, -2449999897.9901892, -72.443642655361211, -.14153185131723035, -9799999897.9901892, -72.463239715753163, -.14155145102323427, -9799999959.2049557, -82.661791803725298, -.22497796011167120, -9800001952.4035150, -98.121819059277218, -.73747231835162234, -99999999.970000600, -.97520661157024793, -.25000000000000000e-2, -180678.29556526271, -.24723183516223411, .14787547592726545e-1, -2449989826.4925760, -14.142472045720712, .20642923349142839e-3, -9799989826.4925760, -14.162069106112663, .18682952748750844e-3, -9800180580.3151623, -73.747231835162234, -.15529509703537263, -9899999998.9900202, -98.165289256198347, -.73750000000000000]

  # case i = 100, j = 50
  f6 = [4.8511779273551036, 4.3969268703667414, 2.3536583416986932, 49.845123538768781, 24.850368792317656, 4.3980217041299147, 249999.85000003691, 49.845246440550301, 4.8523956757564970, 499999.85000003691, 49.850245940600296, 4.8524456752565020, 499999.85012303882, 49.850368792317656, 4.8525671586753693, 499999.85122792686, 49.851472324912196, 4.8536583416986932, 69386.852604403787, 43.529592511038800, 2.3420670490701714, 7.3557665778228879, .37804000592447225, -.36166470938020979e-1, 249850.03690851438, 7.8826136429611838, .32928936273875578e-1, 499850.03690851438, 7.8876131430111788, .32978935773880578e-1, 499957.36076607787, 25.378040005924472, .41837898360743357, 569381.85265440329, 88.984137965584255, 4.8420670490701714, 489994.90005099949, 44.363636363636364, 2.3500000000000000, 224133.06526914091, 23.420670490701714, .26350158405661340, 248503.68792317656, .32698659610710135, -.96319147249500716e-1, 498503.68792317656, .33198609615709635, -.96269147749495716e-1, 724083.07026864096, 48.420670490701714, .71804703860206795, 989989.90010099899, 89.818181818181818, 4.8500000000000000]
  g6 = [-.49974542572748489, -.41297887004250662, -.12475849905447513, -49.989755571438135, -12.499754372328909, -.41298025226818182, -1249999999.9997539, -49.989755721743776, -.49974695822245153, -4999999999.9997539, -49.999754221943751, -.49975695807245353, -4999999999.9997541, -49.999754372328909, -.49975711177231405, -4999999999.9997554, -49.999755729546639, -.49975849905447513, -212000818.08570941, -47.086394711423636, -.36064908665068392, -44.828997536351012, -.74845911149572820, .17599074383109899e-2, -1249999753.9665762, -15.851063037604557, -.12181580780761693e-1, -4999999753.9665762, -15.861061537804532, -.12191580630763693e-1, -4999999994.8389960, -38.248459111495728, -.85016952065821241e-1, -5212000817.5857194, -96.673171570927768, -.73564908665068392, -4899999999.4900102, -48.578512396694215, -.36250000000000000, -1480234295.1847174, -36.064908665068392, -.68467888092957432e-1, -1249975437.2328909, -1.2134758153261945, .32326870364595128e-2, -4999975437.2328909, -1.2234743155261695, .32226871864575128e-2, -6480234245.1947159, -73.564908665068392, -.15524474759708966, -9899999998.9900202, -98.165289256198347, -.73750000000000000]

  # case i = 100, j = 100
  f7 = [-.10000100006722359, -.86152823944479461e-1, -.31048508125398976e-1, -.18999803751983413, -.17029639650881342, -.57205997456308146e-1, -.19999700000000463, -.18009852296761701, -.60446971949078333e-1, -.19999700000000463, -.18009852296761701, -.60446971949078333e-1, -.18999803751983413, -.17029639650881342, -.57205997456308146e-1, -.10000100006722359, -.86152823944479461e-1, -.31048508125398976e-1, 316877.98386061026, 88.394410538651327, 4.8341485820320246, 7178.8310929430844, 11.529063763517782, .17273009855519640, -197.00030420085342, -.50248725285035971, -.51981473508759813e-1, -197.00030420085342, -.50248725285035971, -.51981473508759813e-1, 7178.8310929430844, 11.529063763517782, .17273009855519640, 316877.98386061026, 88.394410538651327, 4.8341485820320246, 989989.90010099899, 89.818181818181818, 4.8500000000000000, 594789.32697581717, 48.341485820320246, .71787097157718884, -1702.9639650881342, -.51978980662464390, -.86626102717979664e-1, -1702.9639650881342, -.51978980662464390, -.86626102717979664e-1, 594789.32697581717, 48.341485820320246, .71787097157718884, 989989.90010099899, 89.818181818181818, 4.8500000000000000]
  g7 = [.14999349998575507e-1, .12722084385724653e-1, .23752922060489958e-2, .19949786690965017e-1, .19363979035405590e-1, .60387590518745860e-2, .19999999933501967e-1, .19702961025212995e-1, .65689282016530686e-2, .19999999933501967e-1, .19702961025212995e-1, .65689282016530686e-2, .19949786690965017e-1, .19363979035405590e-1, .60387590518745860e-2, .14999349998575507e-1, .12722084385724653e-1, .23752922060489958e-2, -2081985524.5062395, -95.743339667349680, -.73385758540815388, -20417302.856538622, -17.065616733740788, -.37905522362997397e-1, 19993.443432522717, .50119928663655602, .49904090986965275e-2, 19993.443432522717, .50119928663655602, .49904090986965275e-2, -20417302.856538622, -17.065616733740788, -.37905522362997397e-1, -2081985524.5062395, -95.743339667349680, -.73385758540815388, -9899999998.9900202, -98.165289256198347, -.73750000000000000, -4746596062.1114980, -73.385758540815388, -.15519236353772069, 1936397.9035405590, .49899094373103026, .38334809001015565e-2, 1936397.9035405590, .49899094373103026, .38334809001015565e-2, -4746596062.1114980, -73.385758540815388, -.15519236353772069, -9899999998.9900202, -98.165289256198347, -.73750000000000000]

  # case i = 100, j = 200
  f8 = [999999.70247526797, 99.702967944533794, 9.7073748373046392, 999999.70024801940, 99.700743408659797, 9.7051750523518197, 999999.70000007441, 99.700495764106665, 9.7049301488655406, 499999.70000007441, 99.690496764006675, 9.7048301498655306, 99.690249019296604, 49.700743408659797, 8.7960841432609106, 9.7023752689661962, 8.7938770354428853, 4.7073748373046392, 1140360.2191478351, 178.43440066508405, 9.8191115291672078, 999916.82886946638, 51.115594334377393, .88901911824451404, 999700.07439943985, 16.224132736298927, .12025216065576495, 499700.07439943985, 16.214133736198937, .12015216165575495, 16.818870466283700, 1.1155943343773927, -.20071790846395052e-1, 140370.21904783610, 87.525309755993145, 4.8191115291672078, 1989979.9002009980, 180.72727272727273, 9.8500000000000000, 1450565.1238214429, 98.191115291672078, 1.6266101516885142, 997007.43408659797, 1.2068928437060479, -.55076872179718668e-1, 497007.43408659797, 1.1968938436060579, -.55176871179728668e-1, 450665.11382244277, 48.191115291672078, .71751924259760509, 989989.90010099899, 89.818181818181818, 4.8500000000000000]
  g8 = [-9999999999.9995070, -99.999507578749204, -.99951313431673685, -9999999999.9995043, -99.999504862106562, -.99951035046532879, -9999999999.9995040, -99.999504561234119, -.99951004217543171, -2499999999.9995040, -99.979507560834169, -.99949004247542771, -99.979507260149377, -24.999504862106562, -.82595663145706433, -.99948697014526246, -.82595385974093992, -.24951313431673685, -10434048767.131121, -193.61119996503405, -1.4805596165405155, -10000000002.711788, -76.764208380628369, -.17454345975286720, -9999999504.0504131, -32.067235758483416, -.29326268887807328e-1, -2499999504.0504131, -32.047238758083466, -.29306269187803328e-1, -102.69179094739461, -1.7642083806283687, -.98974074460273323e-3, -434048768.13110136, -94.437646246025786, -.73055961654051552, -19899999997.990040, -197.33884297520661, -1.4875000000000000, -12983034856.803633, -148.05596165405155, -.32864150756514933, -9999950486.2106562, -2.9412146546504318, .41273772144371546e-3, -2499950486.2106562, -2.9212176542504818, .43273742144771541e-3, -2983034956.7836362, -73.055961654051552, -.15508778855688487, -9899999998.9900202, -98.165289256198347, -.73750000000000000]

  m1 = [f1 f2 f3 f4 f5 f6 f7 f8]
  m2 = [g1 g2 g3 g4 g5 g6 g7 g8]

  @testset for (b, (i, j)) = enumerate(u)
    @testset for (a, (t, θ, λ)) = enumerate(v)
      x, y = SimpleBirthDeathProcess.derivatives_mle(λ - θ, i, j, t, θ)
      @test isapprox(x, m1[a, b], rtol=ϵ)
      @test isapprox(y, m2[a, b], rtol=ϵ)
    end
  end
end
